(function(e,t){"use strict";var n=e.console||{log:function(){}},r=e.jQuery,i=e.angular,o=e.CybozuLabs,a=i.module("md5htmlApp",[]);a.controller("MainCtrl",["$scope","$window",function(e,t){e.supported=!!(t.File&&t.FileReader&&t.FileList)}]),a.factory("md5",["$q","$rootScope",function(e,t){var r=o.MD5,i={};return i.read=function(i){n.log("read callded: ",i);var o=e.defer(),a=new FileReader;return a.onload=function(e){o.resolve(r.calc(e.target.result)),t.$apply()},a.onerror=function(){n.log("onerror callded"),o.reject(this),t.$apply()},a.readAsBinaryString(i),o.promise},i}]),a.controller("md5",["$scope","$window","md5",function(e,r,i){e.files=[],e.$watch("filelist",function(r){if(r){for(var o=function(t){return function(r){t.md5=r,n.log("then called: ",r),e.makeTxt()}},a=r.length-1;a>=0;a--){var s=r[a];i.read(s).then(o(s)),s.md5="Calculating...",e.files.push(s)}e.filelist=t}}),e.clear=function(){e.files=[]};var o=r.URL||r.webkitURL;e.makeTxt=function(){var t=e.files.map(function(e){return e.name+", "+e.md5}).join("\n");e.md5href=o.createObjectURL(new Blob([t],{type:"text/plain"}))}}]),a.directive("selectAll",function(){return function(e,t){t.bind("focus",function(){t.select()})}}),a.directive("dropArea",function(){return function(e,t,n){var i=function(e){e.stopPropagation(),e.preventDefault()};t.bind("dragover",i),t.bind("drop",function(t){i(t),e[n.dropArea]=t.originalEvent.dataTransfer.files,e.$apply()}),t.bind("click",function(){r("input").click()})}}),a.directive("filelistBind",function(){return function(e,t,n){t.bind("change",function(t){e.$apply(function(){e[n.name]=t.target.files})})}})})(window);